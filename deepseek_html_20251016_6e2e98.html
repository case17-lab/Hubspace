<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>网页链接管理工具</title>
    <style>
        :root {
            --primary-color: #3498db;
            --secondary-color: #2980b9;
            --accent-color: #1abc9c;
            --light-color: #f8f9fa;
            --dark-color: #2c3e50;
            --card-bg: #ffffff;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            --hover-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Helvetica Neue', Arial, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #e4edf5 100%);
            color: var(--dark-color);
            line-height: 1.6;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 2.5rem 0;
            text-align: center;
            border-radius: 0 0 20px 20px;
            margin-bottom: 2.5rem;
            box-shadow: var(--shadow);
            position: relative;
            overflow: hidden;
        }

        header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M11 18c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm48 25c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm-43-7c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm63 31c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM34 90c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm56-76c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM12 86c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm28-65c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm23-11c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-6 60c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm29 22c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zM32 63c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm57-13c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-9-21c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM60 91c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM35 41c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM12 60c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z' fill='%23ffffff' fill-opacity='0.1' fill-rule='evenodd'/%3E%3C/svg%3E");
            opacity: 0.3;
        }

        h1 {
            font-size: 2.8rem;
            margin-bottom: 0.5rem;
            font-weight: 700;
            position: relative;
            z-index: 1;
        }

        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
            max-width: 600px;
            margin: 0 auto;
            position: relative;
            z-index: 1;
        }

        .category-section {
            margin-bottom: 3rem;
        }

        .category-title {
            font-size: 1.8rem;
            color: var(--secondary-color);
            margin-bottom: 1.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 3px solid var(--accent-color);
            display: inline-block;
            font-weight: 600;
        }

        .tiles-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
        }

        .tile {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 1.8rem;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            border-top: 5px solid var(--accent-color);
            position: relative;
            overflow: hidden;
        }

        .tile::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary-color), var(--accent-color));
        }

        .tile:hover {
            transform: translateY(-8px);
            box-shadow: var(--hover-shadow);
        }

        .tile-title {
            font-size: 1.4rem;
            font-weight: 600;
            color: var(--dark-color);
            margin-bottom: 0.8rem;
        }

        .tile-description {
            color: #64748b;
            font-size: 1rem;
            flex-grow: 1;
            line-height: 1.5;
        }

        /* 登录模态框 */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(4px);
        }

        .modal-content {
            background: white;
            border-radius: 20px;
            width: 90%;
            max-width: 450px;
            padding: 2.5rem;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.2);
            animation: modalAppear 0.3s ease-out;
        }

        @keyframes modalAppear {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal h2 {
            color: var(--primary-color);
            margin-bottom: 1.8rem;
            text-align: center;
            font-size: 1.8rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.7rem;
            color: var(--dark-color);
            font-weight: 500;
        }

        .form-group input {
            width: 100%;
            padding: 1rem;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 1rem;
            transition: all 0.3s;
        }

        .form-group input:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
            outline: none;
        }

        .btn {
            padding: 1rem 1.8rem;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }

        .btn i {
            margin-right: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            width: 100%;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(52, 152, 219, 0.4);
        }

        .btn-secondary {
            background-color: #e2e8f0;
            color: var(--dark-color);
        }

        .btn-secondary:hover {
            background-color: #cbd5e0;
        }

        .btn-accent {
            background: var(--accent-color);
            color: white;
        }

        .btn-accent:hover {
            background: #16a085;
            transform: translateY(-2px);
        }

        .btn-danger {
            background-color: #e74c3c;
            color: white;
        }

        .btn-danger:hover {
            background-color: #c0392b;
        }

        .btn-sm {
            padding: 0.6rem 1.2rem;
            font-size: 0.9rem;
        }

        .admin-panel {
            display: none;
            margin-top: 2rem;
        }

        .admin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1.5rem;
            border-bottom: 2px solid #e2e8f0;
        }

        .admin-tabs {
            display: flex;
            margin-bottom: 2rem;
            background: white;
            border-radius: 12px;
            padding: 0.5rem;
            box-shadow: var(--shadow);
        }

        .admin-tab {
            padding: 1rem 1.5rem;
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.3s;
            font-weight: 500;
            flex: 1;
            text-align: center;
        }

        .admin-tab.active {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            box-shadow: var(--shadow);
        }

        .admin-content {
            display: none;
            background: white;
            border-radius: 16px;
            padding: 2rem;
            box-shadow: var(--shadow);
        }

        .admin-content.active {
            display: block;
            animation: fadeIn 0.4s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .admin-content h3 {
            color: var(--secondary-color);
            margin-bottom: 1.5rem;
            font-size: 1.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid #e2e8f0;
        }

        .admin-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1.5rem;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        .admin-table th, .admin-table td {
            padding: 1.2rem;
            text-align: left;
            border-bottom: 1px solid #e2e8f0;
        }

        .admin-table th {
            background-color: #f8fafc;
            color: var(--secondary-color);
            font-weight: 600;
        }

        .admin-table tr:last-child td {
            border-bottom: none;
        }

        .form-row {
            display: flex;
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .form-row .form-group {
            flex: 1;
            margin-bottom: 0;
        }

        .action-buttons {
            display: flex;
            gap: 0.8rem;
        }

        .edit-form {
            background: #f8fafc;
            padding: 1.5rem;
            border-radius: 10px;
            margin-top: 1rem;
            border-left: 4px solid var(--accent-color);
        }

        /* 响应式设计 */
        @media (max-width: 1024px) {
            .tiles-container {
                grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            }
        }

        @media (max-width: 768px) {
            .tiles-container {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            }
            
            .admin-tabs {
                flex-wrap: wrap;
            }
            
            .form-row {
                flex-direction: column;
                gap: 1rem;
            }
            
            h1 {
                font-size: 2.2rem;
            }
        }

        @media (max-width: 480px) {
            .tiles-container {
                grid-template-columns: 1fr;
            }
            
            header {
                padding: 2rem 0;
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            .category-title {
                font-size: 1.5rem;
            }
            
            .admin-tab {
                padding: 0.8rem 1rem;
            }
            
            .action-buttons {
                flex-direction: column;
            }
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 1rem 1.5rem;
            border-radius: 10px;
            color: white;
            font-weight: 500;
            box-shadow: var(--shadow);
            z-index: 1100;
            transform: translateX(150%);
            transition: transform 0.3s ease;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.success {
            background: var(--accent-color);
        }

        .notification.error {
            background: #e74c3c;
        }
    </style>
</head>
<body>
    <!-- 主页面 -->
    <div id="main-page">
        <header>
            <div class="container">
                <h1 id="main-title">网页链接导航</h1>
                <p id="main-subtitle" class="subtitle">快速访问您常用的网站</p>
            </div>
        </header>

        <div class="container">
            <div id="categories-container">
                <!-- 分类和链接将通过JavaScript动态生成 -->
            </div>
        </div>
    </div>

    <!-- 登录模态框 -->
    <div id="login-modal" class="modal">
        <div class="modal-content">
            <h2>管理员登录</h2>
            <form id="login-form">
                <div class="form-group">
                    <label for="username">用户名</label>
                    <input type="text" id="username" required>
                </div>
                <div class="form-group">
                    <label for="password">密码</label>
                    <input type="password" id="password" required>
                </div>
                <button type="submit" class="btn btn-primary">登录</button>
            </form>
            <div style="margin-top: 1.5rem; text-align: center; color: #64748b; font-size: 0.9rem;">
                <p>提示：使用 Ctrl+Shift+L 快捷键打开登录窗口</p>
            </div>
        </div>
    </div>

    <!-- 后台管理面板 -->
    <div id="admin-panel" class="admin-panel">
        <div class="container">
            <div class="admin-header">
                <h2>后台管理系统</h2>
                <button id="logout-btn" class="btn btn-secondary">
                    <i>←</i> 退出登录
                </button>
            </div>

            <div class="admin-tabs">
                <div class="admin-tab active" data-tab="settings">页面设置</div>
                <div class="admin-tab" data-tab="links">链接管理</div>
                <div class="admin-tab" data-tab="categories">分类管理</div>
                <div class="admin-tab" data-tab="users">用户管理</div>
            </div>

            <!-- 页面设置 -->
            <div id="settings-tab" class="admin-content active">
                <h3>页面设置</h3>
                <div class="form-group">
                    <label for="site-title">网站标题</label>
                    <input type="text" id="site-title" value="网页链接导航">
                </div>
                <div class="form-group">
                    <label for="site-subtitle">网站副标题</label>
                    <input type="text" id="site-subtitle" value="快速访问您常用的网站">
                </div>
                <button id="save-settings-btn" class="btn btn-primary">保存设置</button>
            </div>

            <!-- 链接管理 -->
            <div id="links-tab" class="admin-content">
                <h3>链接管理</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label for="link-name">链接名称</label>
                        <input type="text" id="link-name">
                    </div>
                    <div class="form-group">
                        <label for="link-url">链接地址</label>
                        <input type="text" id="link-url" placeholder="https://">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="link-description">链接描述</label>
                        <input type="text" id="link-description">
                    </div>
                    <div class="form-group">
                        <label for="link-category">所属分类</label>
                        <select id="link-category">
                            <!-- 分类选项将通过JavaScript动态生成 -->
                        </select>
                    </div>
                </div>
                <button id="add-link-btn" class="btn btn-primary">添加链接</button>

                <table class="admin-table">
                    <thead>
                        <tr>
                            <th>名称</th>
                            <th>URL</th>
                            <th>描述</th>
                            <th>分类</th>
                            <th>操作</th>
                        </tr>
                    </thead>
                    <tbody id="links-table-body">
                        <!-- 链接列表将通过JavaScript动态生成 -->
                    </tbody>
                </table>
            </div>

            <!-- 分类管理 -->
            <div id="categories-tab" class="admin-content">
                <h3>分类管理</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label for="category-name">分类名称</label>
                        <input type="text" id="category-name">
                    </div>
                    <div class="form-group">
                        <label for="category-description">分类描述</label>
                        <input type="text" id="category-description">
                    </div>
                </div>
                <button id="add-category-btn" class="btn btn-primary">添加分类</button>

                <table class="admin-table">
                    <thead>
                        <tr>
                            <th>名称</th>
                            <th>描述</th>
                            <th>操作</th>
                        </tr>
                    </thead>
                    <tbody id="categories-table-body">
                        <!-- 分类列表将通过JavaScript动态生成 -->
                    </tbody>
                </table>
            </div>

            <!-- 用户管理 -->
            <div id="users-tab" class="admin-content">
                <h3>用户管理</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label for="user-username">用户名</label>
                        <input type="text" id="user-username">
                    </div>
                    <div class="form-group">
                        <label for="user-password">密码</label>
                        <input type="password" id="user-password">
                    </div>
                    <div class="form-group">
                        <label for="user-level">权限级别</label>
                        <select id="user-level">
                            <option value="1">普通管理员</option>
                            <option value="2">高级管理员</option>
                        </select>
                    </div>
                </div>
                <button id="add-user-btn" class="btn btn-primary">添加用户</button>

                <table class="admin-table">
                    <thead>
                        <tr>
                            <th>用户名</th>
                            <th>权限级别</th>
                            <th>操作</th>
                        </tr>
                    </thead>
                    <tbody id="users-table-body">
                        <!-- 用户列表将通过JavaScript动态生成 -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- 通知 -->
    <div id="notification" class="notification"></div>

    <script>
        // 数据模型
        let data = {
            siteTitle: "网页链接导航",
            siteSubtitle: "快速访问您常用的网站",
            categories: [
                { id: 1, name: "工作工具", description: "日常工作使用的工具" },
                { id: 2, name: "学习资源", description: "学习和参考资料" },
                { id: 3, name: "娱乐休闲", description: "放松和娱乐网站" }
            ],
            links: [
                { id: 1, categoryId: 1, name: "项目管理", url: "https://trello.com", description: "团队项目管理工具" },
                { id: 2, categoryId: 1, name: "代码仓库", url: "https://github.com", description: "代码版本控制平台" },
                { id: 3, categoryId: 2, name: "在线学习", url: "https://coursera.org", description: "在线课程平台" },
                { id: 4, categoryId: 2, name: "技术文档", url: "https://developer.mozilla.org", description: "Web技术文档" },
                { id: 5, categoryId: 3, name: "视频平台", url: "https://youtube.com", description: "在线视频分享平台" },
                { id: 6, categoryId: 3, name: "社交网络", url: "https://twitter.com", description: "社交媒体平台" }
            ],
            users: [
                { id: 1, username: "admin", password: "YWRtaW4=", level: 2 }, // 密码: admin (base64编码)
                { id: 2, username: "user", password: "dXNlcg==", level: 1 }   // 密码: user (base64编码)
            ],
            currentUser: null
        };

        // 从localStorage加载数据
        function loadData() {
            const savedData = localStorage.getItem('linkManagerData');
            if (savedData) {
                const parsedData = JSON.parse(savedData);
                // 合并数据，确保新添加的属性不会丢失
                data = {...data, ...parsedData};
            }
        }

        // 保存数据到localStorage
        function saveData() {
            localStorage.setItem('linkManagerData', JSON.stringify(data));
        }

        // 初始化数据
        loadData();

        // DOM元素
        const mainPage = document.getElementById('main-page');
        const loginModal = document.getElementById('login-modal');
        const adminPanel = document.getElementById('admin-panel');
        const loginForm = document.getElementById('login-form');
        const logoutBtn = document.getElementById('logout-btn');
        const categoriesContainer = document.getElementById('categories-container');
        const adminTabs = document.querySelectorAll('.admin-tab');
        const adminContents = document.querySelectorAll('.admin-content');
        const notification = document.getElementById('notification');

        // 显示通知
        function showNotification(message, type = 'success') {
            notification.textContent = message;
            notification.className = `notification ${type}`;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        // 更新页面标题和副标题
        function updateSiteTitle() {
            document.getElementById('main-title').textContent = data.siteTitle;
            document.getElementById('main-subtitle').textContent = data.siteSubtitle;
            document.getElementById('site-title').value = data.siteTitle;
            document.getElementById('site-subtitle').value = data.siteSubtitle;
        }

        // 渲染主页面
        function renderMainPage() {
            categoriesContainer.innerHTML = '';
            
            data.categories.forEach(category => {
                const categorySection = document.createElement('div');
                categorySection.className = 'category-section';
                
                const categoryTitle = document.createElement('h2');
                categoryTitle.className = 'category-title';
                categoryTitle.textContent = category.name;
                
                const tilesContainer = document.createElement('div');
                tilesContainer.className = 'tiles-container';
                
                // 获取该分类下的所有链接
                const categoryLinks = data.links.filter(link => link.categoryId === category.id);
                
                categoryLinks.forEach(link => {
                    const tile = document.createElement('div');
                    tile.className = 'tile';
                    tile.addEventListener('click', () => {
                        window.open(link.url, '_blank');
                    });
                    
                    const tileTitle = document.createElement('div');
                    tileTitle.className = 'tile-title';
                    tileTitle.textContent = link.name;
                    
                    const tileDescription = document.createElement('div');
                    tileDescription.className = 'tile-description';
                    tileDescription.textContent = link.description;
                    
                    tile.appendChild(tileTitle);
                    tile.appendChild(tileDescription);
                    tilesContainer.appendChild(tile);
                });
                
                categorySection.appendChild(categoryTitle);
                categorySection.appendChild(tilesContainer);
                categoriesContainer.appendChild(categorySection);
            });
        }

        // 渲染后台管理面板
        function renderAdminPanel() {
            // 更新页面设置
            updateSiteTitle();
            
            // 渲染链接管理
            renderLinksTab();
            
            // 渲染分类管理
            renderCategoriesTab();
            
            // 渲染用户管理
            renderUsersTab();
        }

        // 渲染链接管理标签页
        function renderLinksTab() {
            const linksTableBody = document.getElementById('links-table-body');
            linksTableBody.innerHTML = '';
            
            // 更新分类选择器
            const linkCategorySelect = document.getElementById('link-category');
            linkCategorySelect.innerHTML = '';
            data.categories.forEach(category => {
                const option = document.createElement('option');
                option.value = category.id;
                option.textContent = category.name;
                linkCategorySelect.appendChild(option);
            });
            
            // 渲染链接表格
            data.links.forEach(link => {
                const row = document.createElement('tr');
                
                const category = data.categories.find(cat => cat.id === link.categoryId);
                
                row.innerHTML = `
                    <td>${link.name}</td>
                    <td>${link.url}</td>
                    <td>${link.description}</td>
                    <td>${category ? category.name : '未分类'}</td>
                    <td class="action-buttons">
                        <button class="btn btn-secondary btn-sm edit-link" data-id="${link.id}">编辑</button>
                        <button class="btn btn-danger btn-sm delete-link" data-id="${link.id}">删除</button>
                    </td>
                `;
                
                linksTableBody.appendChild(row);
            });
            
            // 添加事件监听器
            document.querySelectorAll('.edit-link').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const linkId = parseInt(e.target.dataset.id);
                    editLink(linkId);
                });
            });
            
            document.querySelectorAll('.delete-link').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const linkId = parseInt(e.target.dataset.id);
                    deleteLink(linkId);
                });
            });
        }

        // 渲染分类管理标签页
        function renderCategoriesTab() {
            const categoriesTableBody = document.getElementById('categories-table-body');
            categoriesTableBody.innerHTML = '';
            
            data.categories.forEach(category => {
                const row = document.createElement('tr');
                
                row.innerHTML = `
                    <td>${category.name}</td>
                    <td>${category.description}</td>
                    <td class="action-buttons">
                        <button class="btn btn-secondary btn-sm edit-category" data-id="${category.id}">编辑</button>
                        <button class="btn btn-danger btn-sm delete-category" data-id="${category.id}">删除</button>
                    </td>
                `;
                
                categoriesTableBody.appendChild(row);
            });
            
            // 添加事件监听器
            document.querySelectorAll('.edit-category').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const categoryId = parseInt(e.target.dataset.id);
                    editCategory(categoryId);
                });
            });
            
            document.querySelectorAll('.delete-category').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const categoryId = parseInt(e.target.dataset.id);
                    deleteCategory(categoryId);
                });
            });
        }

        // 渲染用户管理标签页
        function renderUsersTab() {
            const usersTableBody = document.getElementById('users-table-body');
            usersTableBody.innerHTML = '';
            
            // 只有高级管理员才能访问用户管理
            if (data.currentUser && data.currentUser.level === 2) {
                document.getElementById('users-tab').style.display = 'block';
                
                data.users.forEach(user => {
                    const row = document.createElement('tr');
                    
                    row.innerHTML = `
                        <td>${user.username}</td>
                        <td>${user.level === 2 ? '高级管理员' : '普通管理员'}</td>
                        <td class="action-buttons">
                            <button class="btn btn-danger btn-sm delete-user" data-id="${user.id}">删除</button>
                        </td>
                    `;
                    
                    usersTableBody.appendChild(row);
                });
                
                // 添加事件监听器
                document.querySelectorAll('.delete-user').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const userId = parseInt(e.target.dataset.id);
                        deleteUser(userId);
                    });
                });
            } else {
                document.getElementById('users-tab').style.display = 'none';
            }
        }

        // 添加链接
        function addLink() {
            const name = document.getElementById('link-name').value;
            const url = document.getElementById('link-url').value;
            const description = document.getElementById('link-description').value;
            const categoryId = parseInt(document.getElementById('link-category').value);
            
            if (name && url && categoryId) {
                const newLink = {
                    id: data.links.length > 0 ? Math.max(...data.links.map(l => l.id)) + 1 : 1,
                    categoryId,
                    name,
                    url,
                    description
                };
                
                data.links.push(newLink);
                saveData();
                renderLinksTab();
                renderMainPage();
                
                // 清空表单
                document.getElementById('link-name').value = '';
                document.getElementById('link-url').value = '';
                document.getElementById('link-description').value = '';
                
                showNotification('链接添加成功！');
            } else {
                showNotification('请填写完整的链接信息！', 'error');
            }
        }

        // 编辑链接
        function editLink(id) {
            const link = data.links.find(l => l.id === id);
            if (link) {
                document.getElementById('link-name').value = link.name;
                document.getElementById('link-url').value = link.url;
                document.getElementById('link-description').value = link.description;
                document.getElementById('link-category').value = link.categoryId;
                
                // 修改添加按钮为更新按钮
                const addBtn = document.getElementById('add-link-btn');
                addBtn.textContent = '更新链接';
                addBtn.onclick = function() { updateLink(id); };
                
                showNotification('正在编辑链接，修改后点击"更新链接"保存');
            }
        }

        // 更新链接
        function updateLink(id) {
            const name = document.getElementById('link-name').value;
            const url = document.getElementById('link-url').value;
            const description = document.getElementById('link-description').value;
            const categoryId = parseInt(document.getElementById('link-category').value);
            
            if (name && url && categoryId) {
                const linkIndex = data.links.findIndex(l => l.id === id);
                if (linkIndex !== -1) {
                    data.links[linkIndex] = {
                        id,
                        categoryId,
                        name,
                        url,
                        description
                    };
                    
                    saveData();
                    renderLinksTab();
                    renderMainPage();
                    
                    // 重置表单和按钮
                    document.getElementById('link-name').value = '';
                    document.getElementById('link-url').value = '';
                    document.getElementById('link-description').value = '';
                    
                    const addBtn = document.getElementById('add-link-btn');
                    addBtn.textContent = '添加链接';
                    addBtn.onclick = addLink;
                    
                    showNotification('链接更新成功！');
                }
            } else {
                showNotification('请填写完整的链接信息！', 'error');
            }
        }

        // 删除链接
        function deleteLink(id) {
            if (confirm('确定要删除这个链接吗？')) {
                data.links = data.links.filter(l => l.id !== id);
                saveData();
                renderLinksTab();
                renderMainPage();
                showNotification('链接删除成功！');
            }
        }

        // 添加分类
        function addCategory() {
            const name = document.getElementById('category-name').value;
            const description = document.getElementById('category-description').value;
            
            if (name) {
                const newCategory = {
                    id: data.categories.length > 0 ? Math.max(...data.categories.map(c => c.id)) + 1 : 1,
                    name,
                    description
                };
                
                data.categories.push(newCategory);
                saveData();
                renderCategoriesTab();
                renderLinksTab();
                renderMainPage();
                
                // 清空表单
                document.getElementById('category-name').value = '';
                document.getElementById('category-description').value = '';
                
                showNotification('分类添加成功！');
            } else {
                showNotification('请填写分类名称！', 'error');
            }
        }

        // 编辑分类
        function editCategory(id) {
            const category = data.categories.find(c => c.id === id);
            if (category) {
                document.getElementById('category-name').value = category.name;
                document.getElementById('category-description').value = category.description;
                
                // 修改添加按钮为更新按钮
                const addBtn = document.getElementById('add-category-btn');
                addBtn.textContent = '更新分类';
                addBtn.onclick = function() { updateCategory(id); };
                
                showNotification('正在编辑分类，修改后点击"更新分类"保存');
            }
        }

        // 更新分类
        function updateCategory(id) {
            const name = document.getElementById('category-name').value;
            const description = document.getElementById('category-description').value;
            
            if (name) {
                const categoryIndex = data.categories.findIndex(c => c.id === id);
                if (categoryIndex !== -1) {
                    data.categories[categoryIndex] = {
                        id,
                        name,
                        description
                    };
                    
                    saveData();
                    renderCategoriesTab();
                    renderLinksTab();
                    renderMainPage();
                    
                    // 重置表单和按钮
                    document.getElementById('category-name').value = '';
                    document.getElementById('category-description').value = '';
                    
                    const addBtn = document.getElementById('add-category-btn');
                    addBtn.textContent = '添加分类';
                    addBtn.onclick = addCategory;
                    
                    showNotification('分类更新成功！');
                }
            } else {
                showNotification('请填写分类名称！', 'error');
            }
        }

        // 删除分类
        function deleteCategory(id) {
            // 检查是否有链接使用此分类
            const linksInCategory = data.links.filter(l => l.categoryId === id);
            
            if (linksInCategory.length > 0) {
                alert('无法删除此分类，因为还有链接属于此分类。请先移动或删除这些链接。');
                return;
            }
            
            if (confirm('确定要删除这个分类吗？')) {
                data.categories = data.categories.filter(c => c.id !== id);
                saveData();
                renderCategoriesTab();
                renderLinksTab();
                renderMainPage();
                showNotification('分类删除成功！');
            }
        }

        // 添加用户
        function addUser() {
            const username = document.getElementById('user-username').value;
            const password = document.getElementById('user-password').value;
            const level = parseInt(document.getElementById('user-level').value);
            
            if (username && password) {
                // 检查用户名是否已存在
                if (data.users.some(u => u.username === username)) {
                    alert('用户名已存在！');
                    return;
                }
                
                const newUser = {
                    id: data.users.length > 0 ? Math.max(...data.users.map(u => u.id)) + 1 : 1,
                    username,
                    password: btoa(password), // 简单的base64编码
                    level
                };
                
                data.users.push(newUser);
                saveData();
                renderUsersTab();
                
                // 清空表单
                document.getElementById('user-username').value = '';
                document.getElementById('user-password').value = '';
                
                showNotification('用户添加成功！');
            } else {
                showNotification('请填写完整的用户信息！', 'error');
            }
        }

        // 删除用户
        function deleteUser(id) {
            // 不能删除当前登录的用户
            if (data.currentUser && data.currentUser.id === id) {
                alert('不能删除当前登录的用户！');
                return;
            }
            
            if (confirm('确定要删除这个用户吗？')) {
                data.users = data.users.filter(u => u.id !== id);
                saveData();
                renderUsersTab();
                showNotification('用户删除成功！');
            }
        }

        // 保存页面设置
        function saveSiteSettings() {
            data.siteTitle = document.getElementById('site-title').value;
            data.siteSubtitle = document.getElementById('site-subtitle').value;
            saveData();
            updateSiteTitle();
            showNotification('页面设置已保存！');
        }

        // 登录功能
        function login(username, password) {
            const user = data.users.find(u => u.username === username && u.password === btoa(password));
            
            if (user) {
                data.currentUser = user;
                saveData();
                
                // 隐藏登录模态框，显示后台管理面板
                loginModal.style.display = 'none';
                mainPage.style.display = 'none';
                adminPanel.style.display = 'block';
                
                // 渲染后台管理面板
                renderAdminPanel();
                
                return true;
            }
            
            return false;
        }

        // 退出登录
        function logout() {
            data.currentUser = null;
            saveData();
            
            // 隐藏后台管理面板，显示主页面
            adminPanel.style.display = 'none';
            mainPage.style.display = 'block';
            
            // 渲染主页面
            renderMainPage();
            
            showNotification('已成功退出登录');
        }

        // 事件监听器
        document.addEventListener('DOMContentLoaded', () => {
            // 更新页面标题
            updateSiteTitle();
            
            // 渲染主页面
            renderMainPage();
            
            // 登录表单提交
            loginForm.addEventListener('submit', (e) => {
                e.preventDefault();
                
                const username = document.getElementById('username').value;
                const password = document.getElementById('password').value;
                
                if (login(username, password)) {
                    // 登录成功，清空表单
                    loginForm.reset();
                    showNotification('登录成功！');
                } else {
                    showNotification('用户名或密码错误！', 'error');
                }
            });
            
            // 退出登录
            logoutBtn.addEventListener('click', logout);
            
            // 后台管理标签切换
            adminTabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    // 移除所有active类
                    adminTabs.forEach(t => t.classList.remove('active'));
                    adminContents.forEach(c => c.classList.remove('active'));
                    
                    // 添加active类到当前标签
                    tab.classList.add('active');
                    
                    // 显示对应的内容
                    const tabId = tab.dataset.tab;
                    document.getElementById(`${tabId}-tab`).classList.add('active');
                });
            });
            
            // 添加链接按钮
            document.getElementById('add-link-btn').addEventListener('click', addLink);
            
            // 添加分类按钮
            document.getElementById('add-category-btn').addEventListener('click', addCategory);
            
            // 添加用户按钮
            document.getElementById('add-user-btn').addEventListener('click', addUser);
            
            // 保存页面设置按钮
            document.getElementById('save-settings-btn').addEventListener('click', saveSiteSettings);
            
            // 快捷键监听
            document.addEventListener('keydown', (e) => {
                // Ctrl+Shift+L 打开登录模态框
                if (e.ctrlKey && e.shiftKey && e.key === 'L') {
                    e.preventDefault();
                    
                    // 如果未登录，显示登录模态框
                    if (!data.currentUser) {
                        loginModal.style.display = 'flex';
                    }
                }
                
                // ESC键关闭模态框
                if (e.key === 'Escape') {
                    loginModal.style.display = 'none';
                }
            });
            
            // 点击模态框外部关闭
            loginModal.addEventListener('click', (e) => {
                if (e.target === loginModal) {
                    loginModal.style.display = 'none';
                }
            });
        });
    </script>
</body>
</html>